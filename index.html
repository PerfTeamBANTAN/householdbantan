<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard Team Performance - Menu Only</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/frappe-gantt@0.6.1/dist/frappe-gantt.css" />
  <style>
    body { font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; }
    .navbar-brand { font-weight: bold; font-size: 24px; color: #444; }
    .nav-link { color: #333; }
    .dropdown-menu a { font-size: 14px; }
    .dropdown-submenu { position: relative; }
    .dropdown-submenu > .dropdown-menu { top: 0; left: 100%; margin-left: 0.1rem; margin-right: 0.1rem; }
    .dropdown-submenu:hover > .dropdown-menu { display: block; }

    .section { padding: 24px; }
    #timeline-tower { background: #fff; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.08); padding: 16px; }
    #gantt { overflow-x: auto; }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">
        <img src="PERFORMANCE TEAM.png" style="height: 40px; margin-right: 10px;" />
        PERFORMANCE BAN-TAN
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          <!-- RACING -->
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="racingDropdown" role="button" data-bs-toggle="dropdown">Rangking</a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#">Rangking Household</a></li>
              <li><a class="dropdown-item" href="#">Rangking B2C</a></li>
              <li><a class="dropdown-item" href="#">Rangking B2B</a></li>
            </ul>
          </li>

          <!-- KPI 12 PI LATEN -->
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="kpi12piDropdown" role="button" data-bs-toggle="dropdown">KPI 12 PI Laten</a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#">Dashboard 12 PI Laten</a></li>
              <li><a class="dropdown-item" href="#">Ranking PI Laten HSA</a></li>
              <li><a class="dropdown-item" href="#">Indikator Not ACH</a></li>
              <li><a class="dropdown-item" href="#">Improvement PI Laten</a></li>
              <li><a class="dropdown-item" href="#timeline-tower">TimeLine Tower</a></li>
            </ul>
          </li>

          <!-- KPI IOAN -->
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="kpiioanDropdown" role="button" data-bs-toggle="dropdown">KPI B2C</a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#">Dashboard B2C</a></li>
              <li><a class="dropdown-item" href="#">Ranking B2C HSA</a></li>
              <li><a class="dropdown-item" href="#">Ranking B2C Mitra</a></li>
              <li><a class="dropdown-item" href="#">Indikator Not ACH</a></li>
              <li><a class="dropdown-item" href="#">Improvement B2C</a></li>
              <li class="dropdown-submenu dropend">
                <a class="dropdown-item dropdown-toggle" href="#">Detail Indikator</a>
                <ul class="dropdown-menu">
                  <li><a class="dropdown-item" href="#">Assurance guarantee All</a></li>
                  <li><a class="dropdown-item" href="#">Service Availability (All Teknis)</a></li>
                  <li><a class="dropdown-item" href="#">Q Gangguan (All Teknis)</a></li>
                  <li><a class="dropdown-item" href="#">TTR COMPLYER</a></li>
                  <li><a class="dropdown-item" href="#">Tangible</a></li>
                  <li><a class="dropdown-item" href="#">Dismantling ex CT0 (Quantity)</a></li>
                  <li><a class="dropdown-item" href="#">VALINS</a></li>
                  <li><a class="dropdown-item" href="#">Validasi Tiang</a></li>
                  <li><a class="dropdown-item" href="#">SQM </a></li>
                  <li><a class="dropdown-item" href="#">SCC </a></li>
                  <li><a class="dropdown-item" href="#">Underspec dan Infracare</a></li>
                  <li><a class="dropdown-item" href="#">Ext Audit</a></li>
                </ul>
              </li>
            </ul>
          </li>

          <!-- KPI NON SEKTOR B2B -->
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="kpiB2BDropdown" role="button" data-bs-toggle="dropdown">KPI Non Sektor B2B</a>
            <ul class="dropdown-menu">
              <li class="dropdown-submenu dropend">
                <a class="dropdown-item dropdown-toggle" href="#">HSI</a>
                <ul class="dropdown-menu">
                  <li><a class="dropdown-item" href="#">Q HSI</a></li>
                  <li><a class="dropdown-item" href="#">ASGAR HSI</a></li>
                  <li><a class="dropdown-item" href="#">TTR HSI</a></li>
                </ul>
              </li>
              <li><a class="dropdown-item" href="#">DATIN</a></li>
              <li><a class="dropdown-item" href="#">WIFI</a></li>
              <li><a class="dropdown-item" href="#">OLO</a></li>
            </ul>
          </li>

          <!-- KPI WSA -->
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="kpiWSADropdown" role="button" data-bs-toggle="dropdown">KPI WSA</a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#">FFG</a></li>
              <li><a class="dropdown-item" href="#">TTI</a></li>
              <li><a class="dropdown-item" href="#">Service Availability</a></li>
              <li><a class="dropdown-item" href="#">Assurance Guarantee</a></li>
              <li><a class="dropdown-item" href="#">TTR</a></li>
            </ul>
          </li>

          <!-- KPI MAINTENANCE -->
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="kpiMTCDropdown" role="button" data-bs-toggle="dropdown">KPI Maintenance</a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#">FTM</a></li>
              <li><a class="dropdown-item" href="#">OLT</a></li>
              <li><a class="dropdown-item" href="#">GAMAS</a></li>
              <li><a class="dropdown-item" href="#">Pengawasan Project P3</a></li>
              <li><a class="dropdown-item" href="#">Patroli Akses</a></li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- TimeLine Tower Section -->
  <section id="timeline-tower" class="section container mt-4">
    <div class="d-flex align-items-center mb-3">
      <h4 class="mb-0">TimeLine Tower - Gantt Chart</h4>
    </div>
    <div class="row g-3">
      <div class="col-12">
        <div id="gantt"></div>
        <div id="gantt-error" class="text-danger mt-2" style="display:none;"></div>
      </div>
    </div>
  </section>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/frappe-gantt@0.6.1/dist/frappe-gantt.umd.js"></script>
  <script>
    Berikut adalah full kode HTML untuk dashboard dengan TimeLine Tower Gantt Chart yang langsung membaca data dari Google Sheet CSV kamu.
File ini sudah lengkap dengan Bootstrap, Frappe Gantt, dan script parsing yang cocok dengan struktur sheet yang sudah kamu lampirkan.

xml
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard Team Performance - TimeLine Tower</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/frappe-gantt@0.6.1/dist/frappe-gantt.css" />
  <style>
    body { font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; }
    .navbar-brand { font-weight: bold; font-size: 24px; color: #444; }
    .section { padding: 24px; }
    #timeline-tower { background: #fff; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.08); padding: 16px; }
    #gantt { overflow-x: auto; }
    #gantt-error { display:none; }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">PERFORMANCE BAN-TAN</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          <!-- Tambah menu lain jika diperlukan -->
          <li class="nav-item"><a class="nav-link" href="#timeline-tower">TimeLine Tower</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- TimeLine Tower Section -->
  <section id="timeline-tower" class="section container mt-4">
    <div class="d-flex align-items-center mb-3">
      <h4 class="mb-0">TimeLine Tower - Gantt Chart</h4>
    </div>
    <div class="row g-3">
      <div class="col-12">
        <div id="gantt"></div>
        <div id="gantt-error" class="text-danger mt-2"></div>
      </div>
    </div>
  </section>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/frappe-gantt@0.6.1/dist/frappe-gantt.umd.js"></script>
  <script>
    const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRcHZK2xNVK-lRfq_MnNF7MK_4x1iUQJL4ECSf7bBL51Yf7yHdbmGgv5RwtD0RZC6NULyTW7h3-E3o1/pub?gid=1842046587&single=true&output=csv";

    function parseCSV(csv) {
      const lines = csv.trim().split(/\r?\n/);
      const headers = lines.shift().split(',').map(h => h.trim());
      return lines.map(line => {
        const cells = [];
        let current = '';
        let inQuotes = false;
        for (let i = 0; i < line.length; i++) {
          const ch = line[i];
          if (ch === '"') inQuotes = !inQuotes;
          else if (ch === ',' && !inQuotes) {
            cells.push(current);
            current = '';
          } else current += ch;
        }
        cells.push(current);
        const obj = {};
        headers.forEach((h, idx) => {
          obj[h.replace(/^[\"']|[\"']$/g, '').trim()] = (cells[idx] || '').replace(/^[\"']|[\"']$/g, '').trim();
        });
        return obj;
      });
    }

    function toGanttTasks(rows) {
      return rows.map((r, idx) => {
        const status = (r["Status Progress"] || r["status"] || "").trim();
        const progressMap = { "Selesai": 100, "CLOSED": 100, "TECH CLOSE": 100, "CANCELLED": 0, "Cancel": 0 };
        let s = (r["created_at"] || "").slice(0, 10);
        let e = (r["closed_at"] || "").slice(0, 10);
        if (!e) e = s;
        return {
          id: r["id"] || r["no"] || `task_${idx + 1}`,
          name: r["site_name_down"] || r["site_name_detect"] || r["tt_site"] || `Task ${idx + 1}`,
          start: s,
          end: e,
          progress: progressMap[status] !== undefined ? progressMap[status] : 50,
          dependencies: ""
        };
      }).filter(t => t.name && t.start && t.end);
    }

    async function loadAndRenderGantt() {
      const errEl = document.getElementById('gantt-error');
      try {
        const res = await fetch(CSV_URL, { cache: 'no-store' });
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const csv = await res.text();
        const rows = parseCSV(csv);
        const tasks = toGanttTasks(rows);
        if (!tasks.length) throw new Error('No tasks parsed from sheet (mapping kolom salah atau data kosong).');
        new Gantt('#gantt', tasks, {
          view_mode: 'Week',
          date_format: 'YYYY-MM-DD',
          language: 'en',
          custom_popup_html: task => `
            <div class="p-2">
              <h6 class="mb-1">${task.name}</h6>
              <div class="text-muted small">${task.start} - ${task.end}</div>
              <div class="mt-1">Progress: <strong>${task.progress}%</strong></div>
            </div>
          `
        });
        errEl.style.display = "none";
      } catch (e) {
        console.error('Failed to load Gantt data:', e);
        errEl.style.display = 'block';
        errEl.textContent = 'Gagal memuat data dari Google Sheet: ' + e.message + '. Pastikan sheet dipublikasikan untuk diakses publik dan data sesuai format.';
      }
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', loadAndRenderGantt);
    } else {
      loadAndRenderGantt();
    }

  </script>
</body>
</html>

